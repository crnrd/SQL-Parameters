with velocity_counters as 
(select p.id as payment_id, p.created_at, credit_card, email, 

bin_num_payments_baseline,
bin_num_payments_last_10_mins,
bin_num_payments_last_30_mins,
bin_num_payments_last_1_hour,
bin_num_payments_last_4_hours,
bin_num_payments_last_12_hours,
bin_num_payments_last_24_hours,
bin_num_payments_last_36_hours,
bin_num_payments_last_72_hours,
bin_num_payments_last_7_days,
bin_ratio_payments_last_10_mins_and_baseline,
bin_ratio_payments_last_30_mins_and_baseline,
bin_ratio_payments_last_1_hour_and_baseline,
bin_ratio_payments_last_4_hours_and_baseline,
bin_ratio_payments_last_12_hours_and_baseline,
bin_ratio_payments_last_24_hours_and_baseline,
bin_ratio_payments_last_36_hours_and_baseline,
bin_ratio_payments_last_72_hours_and_baseline,
bin_ratio_payments_last_7_days_and_baseline,
bin_num_emails_baseline,
bin_num_emails_last_10_mins,
bin_num_emails_last_30_mins,
bin_num_emails_last_1_hour,
bin_num_emails_last_4_hours,
bin_num_emails_last_12_hours,
bin_num_emails_last_24_hours,
bin_num_emails_last_36_hours,
bin_num_emails_last_72_hours,
bin_num_emails_last_7_days,
bin_ratio_emails_last_10_mins_and_baseline,
bin_ratio_emails_last_30_mins_and_baseline,
bin_ratio_emails_last_1_hour_and_baseline,
bin_ratio_emails_last_4_hours_and_baseline,
bin_ratio_emails_last_12_hours_and_baseline,
bin_ratio_emails_last_24_hours_and_baseline,
bin_ratio_emails_last_36_hours_and_baseline,
bin_ratio_emails_last_72_hours_and_baseline,
bin_ratio_emails_last_7_days_and_baseline,
bin_total_approved_amount_baseline,
bin_total_approved_amount_last_10_mins,
bin_total_approved_amount_last_30_mins,
bin_total_approved_amount_last_1_hour,
bin_total_approved_amount_last_4_hours,
bin_total_approved_amount_last_12_hours,
bin_total_approved_amount_last_24_hours,
bin_total_approved_amount_last_36_hours,
bin_total_approved_amount_last_72_hours,
bin_total_approved_amount_last_7_days,
bin_ratio_approved_amount_last_10_mins_and_baseline,
bin_ratio_approved_amount_last_30_mins_and_baseline,
bin_ratio_approved_amount_last_1_hour_and_baseline,
bin_ratio_approved_amount_last_4_hours_and_baseline,
bin_ratio_approved_amount_last_12_hours_and_baseline,
bin_ratio_approved_amount_last_24_hours_and_baseline,
bin_ratio_approved_amount_last_36_hours_and_baseline,
bin_ratio_approved_amount_last_72_hours_and_baseline,
bin_ratio_approved_amount_last_7_days_and_baseline,
bin_num_failed_auths_baseline,
bin_num_failed_auths_last_10_mins,
bin_num_failed_auths_last_30_mins,
bin_num_failed_auths_last_1_hour,
bin_num_failed_auths_last_4_hours,
bin_num_failed_auths_last_12_hours,
bin_num_failed_auths_last_24_hours,
bin_num_failed_auths_last_36_hours,
bin_num_failed_auths_last_72_hours,
bin_num_failed_auths_last_7_days,
bin_ratio_failed_auths_last_10_mins_and_baseline,
bin_ratio_failed_auths_last_30_mins_and_baseline,
bin_ratio_failed_auths_last_1_hour_and_baseline,
bin_ratio_failed_auths_last_4_hours_and_baseline,
bin_ratio_failed_auths_last_12_hours_and_baseline,
bin_ratio_failed_auths_last_24_hours_and_baseline,
bin_ratio_failed_auths_last_36_hours_and_baseline,
bin_ratio_failed_auths_last_72_hours_and_baseline,
bin_ratio_failed_auths_last_7_days_and_baseline,
bin_num_approved_payments_baseline,
bin_num_approved_payments_last_10_mins,
bin_num_approved_payments_last_30_mins,
bin_num_approved_payments_last_1_hour,
bin_num_approved_payments_last_4_hours,
bin_num_approved_payments_last_12_hours,
bin_num_approved_payments_last_24_hours,
bin_num_approved_payments_last_36_hours,
bin_num_approved_payments_last_72_hours,
bin_num_approved_payments_last_7_days,
bin_ratio_approved_payments_last_10_mins_and_baseline,
bin_ratio_approved_payments_last_30_mins_and_baseline,
bin_ratio_approved_payments_last_1_hour_and_baseline,
bin_ratio_approved_payments_last_4_hours_and_baseline,
bin_ratio_approved_payments_last_12_hours_and_baseline,
bin_ratio_approved_payments_last_24_hours_and_baseline,
bin_ratio_approved_payments_last_36_hours_and_baseline,
bin_ratio_approved_payments_last_72_hours_and_baseline,
bin_ratio_approved_payments_last_7_days_and_baseline,
bin_num_cancelled_payments_baseline,
bin_num_cancelled_payments_last_10_mins,
bin_num_cancelled_payments_last_30_mins,
bin_num_cancelled_payments_last_1_hour,
bin_num_cancelled_payments_last_4_hours,
bin_num_cancelled_payments_last_12_hours,
bin_num_cancelled_payments_last_24_hours,
bin_num_cancelled_payments_last_36_hours,
bin_num_cancelled_payments_last_72_hours,
bin_num_cancelled_payments_last_7_days,
bin_ratio_cancelled_payments_last_10_mins_and_baseline,
bin_ratio_cancelled_payments_last_30_mins_and_baseline,
bin_ratio_cancelled_payments_last_1_hour_and_baseline,
bin_ratio_cancelled_payments_last_4_hours_and_baseline,
bin_ratio_cancelled_payments_last_12_hours_and_baseline,
bin_ratio_cancelled_payments_last_24_hours_and_baseline,
bin_ratio_cancelled_payments_last_36_hours_and_baseline,
bin_ratio_cancelled_payments_last_72_hours_and_baseline,
bin_ratio_cancelled_payments_last_7_days_and_baseline,
bin_num_declined_payments_baseline,
bin_num_declined_payments_last_10_mins,
bin_num_declined_payments_last_30_mins,
bin_num_declined_payments_last_1_hour,
bin_num_declined_payments_last_4_hours,
bin_num_declined_payments_last_12_hours,
bin_num_declined_payments_last_24_hours,
bin_num_declined_payments_last_36_hours,
bin_num_declined_payments_last_72_hours,
bin_num_declined_payments_last_7_days,
bin_ratio_declined_payments_last_10_mins_and_baseline,
bin_ratio_declined_payments_last_30_mins_and_baseline,
bin_ratio_declined_payments_last_1_hour_and_baseline,
bin_ratio_declined_payments_last_4_hours_and_baseline,
bin_ratio_declined_payments_last_12_hours_and_baseline,
bin_ratio_declined_payments_last_24_hours_and_baseline,
bin_ratio_declined_payments_last_36_hours_and_baseline,
bin_ratio_declined_payments_last_72_hours_and_baseline,
bin_ratio_declined_payments_last_7_days_and_baseline,
bin_num_approved_emails_baseline,
bin_num_approved_emails_last_10_mins,
bin_num_approved_emails_last_30_mins,
bin_num_approved_emails_last_1_hour,
bin_num_approved_emails_last_4_hours,
bin_num_approved_emails_last_12_hours,
bin_num_approved_emails_last_24_hours,
bin_num_approved_emails_last_36_hours,
bin_num_approved_emails_last_72_hours,
bin_num_approved_emails_last_7_days,
bin_ratio_approved_emails_last_10_mins_and_baseline,
bin_ratio_approved_emails_last_30_mins_and_baseline,
bin_ratio_approved_emails_last_1_hour_and_baseline,
bin_ratio_approved_emails_last_4_hours_and_baseline,
bin_ratio_approved_emails_last_12_hours_and_baseline,
bin_ratio_approved_emails_last_24_hours_and_baseline,
bin_ratio_approved_emails_last_36_hours_and_baseline,
bin_ratio_approved_emails_last_72_hours_and_baseline,
bin_ratio_approved_emails_last_7_days_and_baseline,
bin_num_cancelled_emails_baseline,
bin_num_cancelled_emails_last_10_mins,
bin_num_cancelled_emails_last_30_mins,
bin_num_cancelled_emails_last_1_hour,
bin_num_cancelled_emails_last_4_hours,
bin_num_cancelled_emails_last_12_hours,
bin_num_cancelled_emails_last_24_hours,
bin_num_cancelled_emails_last_36_hours,
bin_num_cancelled_emails_last_72_hours,
bin_num_cancelled_emails_last_7_days,
bin_ratio_cancelled_emails_last_10_mins_and_baseline,
bin_ratio_cancelled_emails_last_30_mins_and_baseline,
bin_ratio_cancelled_emails_last_1_hour_and_baseline,
bin_ratio_cancelled_emails_last_4_hours_and_baseline,
bin_ratio_cancelled_emails_last_12_hours_and_baseline,
bin_ratio_cancelled_emails_last_24_hours_and_baseline,
bin_ratio_cancelled_emails_last_36_hours_and_baseline,
bin_ratio_cancelled_emails_last_72_hours_and_baseline,
bin_ratio_cancelled_emails_last_7_days_and_baseline,
bin_num_declined_emails_baseline,
bin_num_declined_emails_last_10_mins,
bin_num_declined_emails_last_30_mins,
bin_num_declined_emails_last_1_hour,
bin_num_declined_emails_last_4_hours,
bin_num_declined_emails_last_12_hours,
bin_num_declined_emails_last_24_hours,
bin_num_declined_emails_last_36_hours,
bin_num_declined_emails_last_72_hours,
bin_num_declined_emails_last_7_days,
bin_ratio_declined_emails_last_10_mins_and_baseline,
bin_ratio_declined_emails_last_30_mins_and_baseline,
bin_ratio_declined_emails_last_1_hour_and_baseline,
bin_ratio_declined_emails_last_4_hours_and_baseline,
bin_ratio_declined_emails_last_12_hours_and_baseline,
bin_ratio_declined_emails_last_24_hours_and_baseline,
bin_ratio_declined_emails_last_36_hours_and_baseline,
bin_ratio_declined_emails_last_72_hours_and_baseline,
bin_ratio_declined_emails_last_7_days_and_baseline,
bin_num_fraud_warning_payments_baseline,
bin_num_fraud_warning_payments_last_10_mins,
bin_num_fraud_warning_payments_last_30_mins,
bin_num_fraud_warning_payments_last_1_hour,
bin_num_fraud_warning_payments_last_4_hours,
bin_num_fraud_warning_payments_last_12_hours,
bin_num_fraud_warning_payments_last_24_hours,
bin_num_fraud_warning_payments_last_36_hours,
bin_num_fraud_warning_payments_last_72_hours,
bin_num_fraud_warning_payments_last_7_days,
bin_num_fraud_warning_payments_last_14_days,
bin_ratio_fraud_warning_payments_last_10_mins_and_baseline,
bin_ratio_fraud_warning_payments_last_30_mins_and_baseline,
bin_ratio_fraud_warning_payments_last_1_hour_and_baseline,
bin_ratio_fraud_warning_payments_last_4_hours_and_baseline,
bin_ratio_fraud_warning_payments_last_12_hours_and_baseline,
bin_ratio_fraud_warning_payments_last_24_hours_and_baseline,
bin_ratio_fraud_warning_payments_last_36_hours_and_baseline,
bin_ratio_fraud_warning_payments_last_72_hours_and_baseline,
bin_ratio_fraud_warning_payments_last_7_days_and_baseline,
bin_num_fraud_warning_emails_baseline,
bin_num_fraud_warning_emails_last_10_mins,
bin_num_fraud_warning_emails_last_30_mins,
bin_num_fraud_warning_emails_last_1_hour,
bin_num_fraud_warning_emails_last_4_hours,
bin_num_fraud_warning_emails_last_12_hours,
bin_num_fraud_warning_emails_last_24_hours,
bin_num_fraud_warning_emails_last_36_hours,
bin_num_fraud_warning_emails_last_72_hours,
bin_num_fraud_warning_emails_last_7_days,
bin_ratio_fraud_warning_emails_last_10_mins_and_baseline,
bin_ratio_fraud_warning_emails_last_30_mins_and_baseline,
bin_ratio_fraud_warning_emails_last_1_hour_and_baseline,
bin_ratio_fraud_warning_emails_last_4_hours_and_baseline,
bin_ratio_fraud_warning_emails_last_12_hours_and_baseline,
bin_ratio_fraud_warning_emails_last_24_hours_and_baseline,
bin_ratio_fraud_warning_emails_last_36_hours_and_baseline,
bin_ratio_fraud_warning_emails_last_72_hours_and_baseline,
bin_ratio_fraud_warning_emails_last_7_days_and_baseline,
bin_num_chargeback_payments_baseline,
bin_num_chargeback_payments_last_10_mins,
bin_num_chargeback_payments_last_30_mins,
bin_num_chargeback_payments_last_1_hour,
bin_num_chargeback_payments_last_4_hours,
bin_num_chargeback_payments_last_12_hours,
bin_num_chargeback_payments_last_24_hours,
bin_num_chargeback_payments_last_36_hours,
bin_num_chargeback_payments_last_72_hours,
bin_num_chargeback_payments_last_7_days,
bin_num_chargeback_payments_last_14_days,
bin_ratio_chargeback_payments_last_10_mins_and_baseline,
bin_ratio_chargeback_payments_last_30_mins_and_baseline,
bin_ratio_chargeback_payments_last_1_hour_and_baseline,
bin_ratio_chargeback_payments_last_4_hours_and_baseline,
bin_ratio_chargeback_payments_last_12_hours_and_baseline,
bin_ratio_chargeback_payments_last_24_hours_and_baseline,
bin_ratio_chargeback_payments_last_36_hours_and_baseline,
bin_ratio_chargeback_payments_last_72_hours_and_baseline,
bin_ratio_chargeback_payments_last_7_days_and_baseline,
bin_num_chargeback_emails_baseline,
bin_num_chargeback_emails_last_10_mins,
bin_num_chargeback_emails_last_30_mins,
bin_num_chargeback_emails_last_1_hour,
bin_num_chargeback_emails_last_4_hours,
bin_num_chargeback_emails_last_12_hours,
bin_num_chargeback_emails_last_24_hours,
bin_num_chargeback_emails_last_36_hours,
bin_num_chargeback_emails_last_72_hours,
bin_num_chargeback_emails_last_7_days,
bin_ratio_chargeback_emails_last_10_mins_and_baseline,
bin_ratio_chargeback_emails_last_30_mins_and_baseline,
bin_ratio_chargeback_emails_last_1_hour_and_baseline,
bin_ratio_chargeback_emails_last_4_hours_and_baseline,
bin_ratio_chargeback_emails_last_12_hours_and_baseline,
bin_ratio_chargeback_emails_last_24_hours_and_baseline,
bin_ratio_chargeback_emails_last_36_hours_and_baseline,
bin_ratio_chargeback_emails_last_72_hours_and_baseline,
bin_ratio_chargeback_emails_last_7_days_and_baseline

FROM r_payments rp, payments p, velocity_full_sim_max v
WHERE rp.id = v.payment_id AND rp.simplex_payment_id = p.id),

labels as (select * from mv_all_labels, velocity_counters where mv_all_labels.payment_id = velocity_counters.payment_id), 

sim as (select * from simulator_results where id = 4189)

select * from labels limit 5;
select * from mv_all_labels order by 1 desc limit 50;

select * from simulator_runs order by id desc limit 200;

